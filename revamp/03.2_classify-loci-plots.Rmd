---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Setup 

```{r}

"%&%" <- function(a,b) paste0(a,b)

library("tidyverse")
library("data.table")
library("Homo.sapiens")

#fuse.path <- "/Users/jtorres/"
fuse.path <- "/home/jason/science/servers/"
serv.dir <- fuse.path %&% "FUSE5/"
proj.dir <- serv.dir %&% "projects/t2d_classification/"
work.dir <- proj.dir %&% "revamp/"
analysis.dir <- work.dir %&% "analysis_files/"
plot.dir <- work.dir %&% "plots/"

cred.df <- fread(work.dir %&% "genetic_credible_sets/gencred.txt")
cred.df$Locus.ID <- cred.df$CondID

df <- fread(analysis.dir%&%"classified-loci_weighted.txt")

```



```{r}

df2 <- rbind(table(df$assigned_00),
      table(df$assigned_20),
      table(df$assigned_50),
      table(df$assigned_80)) %>% as.data.frame(.)

Tissue <- rep(names(df2),4)
Count <- c(df2[1,],df2[2,],df2[3,],df2[4,]) %>% as.integer(.)
Threshold <- c(rep("0.0",5),rep("0.2",5),rep("0.5",5),rep("0.8",5))

df3 <- data.frame(Tissue,Count,Threshold,stringsAsFactors = TRUE)

plt <- ggplot(data=df3,aes(x=Threshold,y=Count)) + 
  geom_bar(stat="identity",aes(fill=Tissue),color="black") + 
  theme_bw() + 
  scale_fill_manual(values=c("gold1","olivedrab2","brown","red","grey")) + 
  scale_y_continuous(breaks=seq(0,380,40),limits = c(0,380))


ggsave(plot=plt,filename=plot.dir%&%"classifier_counts.png",height = 5,width=5)
ggsave(plot=plt,filename=plot.dir%&%"classifier_counts.pdf",height = 5,width=5)

```


```{r}

count.df <- cbind(Threshold=c("0.0","0.2","0.5","0.8"),df2)
names(count.df) <- c("Threshold","Adipose","Islet","Liver","Muscle","Unclassified")
write.table(x=count.df,file=analysis.dir%&%"classifier_counts.txt",
            sep="\t",quote=F,row.names=F)

```


```{r}

library("grid");library("gridExtra")

gtab <- tableGrob(count.df)
grid.draw(gtab)

ggsave(plot=gtab,filename=plot.dir%&%"classifier_count_table.png",height = 5,width=5)
ggsave(plot=gtab,filename=plot.dir%&%"classifier_count_table.pdf",height = 5,width=5)

```


